# Nest4CSharp
an open source nest algorithm by C# based on SVGNest

## PolyTree
PolyTree是一种只读数据结构，只能用于接收来自剪裁和偏移操作的解决方案。它是Paths数据结构的一种替代方案，该数据结构也接收这些解决方案。PolyTree相对于Paths结构的两个主要优点是：它正确地表示了返回多边形的父子关系；它区分开放路径和封闭路径。然而，由于PolyTree是一个比Paths结构更复杂的结构，并且处理它的计算成本更高（Execute方法大约慢5-10%），因此仅当需要父子多边形关系时，或者当打开的路径被“剪裁”时，才应使用它。  
[PolyTree](https://documentation.help/polyclipping/_Body6.htm)

## CommonUtil.polygonOffset函数
这个函数会把多边形往外扩一段距离offset，并且在每两个相邻的原始顶点之间插入了一个新的顶点，从而形成了一个更加平滑的路径。  
例如一个多边形 (20, 320) (20, 370) (70, 370) (70, 320)，在往外扩了5个单位后，结果如图：

![alt text](/assets/image.png)

## NfpUtil.nfpGenerator
计算两个多边形的NFP，譬如用python描述
```Python
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['SimHei']  # Windows系统下的字体

# 第一组顶点集合
x_coords1 = [1136.1, 1136.1, 1136.6, 1136.6, 1137.25, 1140.1, 1141.1, 1180.05, 1188.82, 1193.9, 1196.9, 1196.9, 1245.5, 1245.5, 1250.5, 1264.5, 1269.5, 1269.5, 1318.1, 1318.1, 1321.1, 1326.18, 1334.95, 1373.9, 1374.9, 1377.9, 1377.9, 1348.1, 1329.29, 1318.26, 1317.8, 1311.97, 1315.8, 1315.8, 1311.8, 1305.5, 1287.5, 1257.5, 1257.5, 1256.33, 1243.5, 1201.91, 1197.66, 1197.2, 1166.9, 1148.09, 1137.06, 1136.6, 1130.77, 1134.6, 1134.6, 1130.6, 1124.3, 1106.3, 1076.3, 1076.3, 1075.13, 1062.3, 1020.71, 1016.46, 1000, 1000, 1016, 1016, 1016.5, 1016.5, 1024.5, 1128.1]
y_coords1 = [1008.0, 1014.25, 1014.25, 1074.85, 1075.5, 1071.85, 1037.35, 1037.35, 1044.33, 1066.35, 1069.35, 1075.35, 1075.35, 1060.35, 1055.35, 1055.35, 1060.35, 1075.35, 1075.35, 1069.35, 1066.35, 1044.33, 1037.35, 1037.35, 1071.85, 1075.35, 1236.45, 1266.75, 1266.75, 1236.45, 1236.15, 1241.93, 1245.76, 1280.75, 1284.75, 1284.75, 1266.75, 1266.75, 1269.0899, 1271.92, 1284.75, 1284.75, 1236.45, 1236.15, 1266.75, 1266.75, 1236.45, 1236.15, 1241.93, 1245.76, 1280.75, 1284.75, 1284.75, 1266.75, 1266.75, 1269.0899, 1271.92, 1284.75, 1284.75, 1236.45, 1215.75, 1079.64, 1075.35, 1014.25, 1014.25, 1008.0, 1000.0, 1000.0]

# 第二组顶点集合
x_coords2 = [1000, 0, 0, 1000, 1000]
y_coords2 = [1000, 1000, 0, 0, 1000]


# 第三组顶点集合
x_coords3 = [136.0999, 758.1999, 758.1999, 136.0999, 136.0999]
y_coords3 = [8.0, 8.0, 723.25, 723.25, 8.0]

# 创建一个新的图形
plt.figure()

# 绘制第一个多边形
plt.plot(x_coords1, y_coords1, 'b-', label='Polygon 1')

# 绘制第二个多边形
plt.plot(x_coords2, y_coords2, 'r-', label='Bin Polygon')

plt.plot(x_coords3, y_coords3, 'g-', label='NFP Polygon')


# 设置图表标题和坐标轴标签
plt.title('多边形')
plt.xlabel('x坐标')
plt.ylabel('y坐标')

# 添加图例
plt.legend()

# 显示网格
plt.grid(True)

# 使x轴和y轴具有相同的刻度，防止多边形变形
plt.axis('equal')

# 显示图表
plt.show()
```
结果为![alt text](/assets/nfp_result.png)